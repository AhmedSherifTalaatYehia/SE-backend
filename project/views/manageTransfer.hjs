<!DOCTYPE html>
<html>
  <head>
    <title>Manage Transfer</title>
    <link rel='stylesheet' href='/styles/bootstrap.min.css' />
    <link rel='stylesheet' href='/styles/style.css' />
    <script src="/js/jquery-2.2.0.min.js" type="text/javascript"></script>
    <script src="/js/bootstrap.min.js" type="text/javascript"></script>
  </head>
  <body>
      <script>
      $(document).ready(function() {
        const sessionToken = document.cookie.includes('session_token');
        if (!sessionToken) {
          location.href = '/';
        }

        $(".reject").click(function(){
          var id = $(this).attr("id");
          console.log("id",id)
          // /api/v1/transfers/:transferId
          $.ajax({
          type: "POST",
          url: `/api/v1/transfers/${id}`,
          data : { transferStatus : "rejected" },
          success: function(data) {
              alert("reject response")
            },
            error: function(errorResponse) {
              if(errorResponse) {
                alert(`User login error: ${errorResponse.responseText}`);
              }            
            }
          });
        
        });

         $(".approve").click(function(){
          var id = $(this).attr("id");
          console.log("id",id)
          // /api/v1/transfers/:transferId
          $.ajax({
          type: "POST",
          url: `/api/v1/transfers/${id}`,
          data : { transferStatus : "accepted" },
          success: function(data) {
              alert("reject response")
            },
            error: function(errorResponse) {
              if(errorResponse) {
                alert(`User login error: ${errorResponse.responseText}`);
              }            
            }
          });
        
        });


      });
      </script> 
    <div>
      <div>
        <nav class="navbar navbar-inverse" style="padding-left:130px;">
          <ul class="nav navbar-nav">
            <li><a href="/dashboard">Home</a></li>
            <li><a href="/manage/grades">Grades</a></li>
            <li ><a href="/manage/courses">Courses</a></li>
            <li class="active"><a href="/manage/transfers">Requests</a></li>
            <li><a href="/">Logout</a></li>
          </ul>
       </nav>
        <table class="table">
          <thead id = "thead">
            <tr>
              <th scope="col">User ID</th>
              <th scope="col">Current Faculty</th>
              <th scope="col">New Faculty</th>
              <th scope="col">Date</th>
              <th scope="col">Status</th>
            </tr>
          </thead>
          <tbody id = "tbody">
               {{#requests}}
                   <tr>
                    <td>{{userId}}</td>
                    <td>{{currentFaculty}}</td>
                    <td>{{newFaculty}}</td>
                    <td>{{date}}</td>
                    <td>{{status}}</td>
                     <td class="text-center">
                            <button id={{id}} class="btn btn-danger approve" type="button">Approve</button>
                          </td>
                          <td class="text-center">
                            <button id={{id}} class="btn btn-danger reject" type="button">Reject</button>
                          </td>
                   </tr>
                {{/requests}}          
          </tbody>
      </table>
        
  </body>
  </html>
